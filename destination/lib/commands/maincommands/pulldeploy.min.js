/*! ScrimBot - v0.0.1 - 2016-03-06\n* Copyright (c) 2016 Jordan Dalton; Licensed  */var userUtil=require("../../utils/user.js"),pullDeployCommand={description:"Fetch code from github and stop the bot",permission:function(a){return userUtil.isAdmin(a.channel.server,a.author)},process:function(a,b,c){a.sendMessage(b.channel,"Updating...",function(b,c){console.log("updating...");var d=require("child_process").spawn,e=d("git",["fetch"]);e.stdout.on("data",function(a){console.log(a.toString())}),e.on("close",function(b){var e,f=d("git",["merge","origin/master"]);f.stdout.on("data",function(a){console.log(a.toString()),e=a}),f.on("close",function(b){console.log("goodbye"),a.updateMessage(c,"Applying update:\n"+e,function(){"Already up-to-date."!=e&&a.logout(function(){process.exit()})})})})})}};module.exports=pullDeployCommand;